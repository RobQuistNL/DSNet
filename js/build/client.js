"use strict";var __dsnet__connections=[],__dsnet__socket_counter=0,__dsnet_js_debug=!1,__dsnet_js_verbose=!1;function dsnet_js_ws_supported(){return"WebSocket"in window}function dsnet_js_connect(_,t,e){if(!dsnet_js_ws_supported())return alert("WebSockets are not supported by this browser."),0;var s={host:_,port:t,connected:!1,ws_handle:void 0,receive_buffer:e,receive_buffer_view:new Uint8Array(e,e.byteOffset,e.byteLength)},o=__dsnet__socket_counter;__dsnet__socket_counter++;return(__dsnet__connections[o]=s).ws_handle=new WebSocket("ws://"+_+":"+t,"dsnet"),s.ws_handle.onopen=function(){s.connected=!0,__dsnet_js_debug&&console.log("DSNET_WS: Connected to "+_+":"+t+" on socket "+o),gml_Script_gmcallback_dsnet_connect(-1,-1,o,s.host)},s.ws_handle.onmessage=function(e){__dsnet_js_debug&&console.log("DSNET_WS: Received message from socket "+o+"; "+_+":"+t+":",e.data);var n=new FileReader;n.onload=function(e){for(var n=e.target.result,_=new Uint8Array(n,n.byteOffset,n.byteLength),t=0;t<n.byteLength;t++)s.receive_buffer_view[t]=_[t];gml_Script_gmcallback_dsnet_data(-1,-1,o,o,n.byteLength)},n.readAsArrayBuffer(e.data)},s.ws_handle.onclose=function(){__dsnet_js_debug&&console.log("DSNET_WS: Connection to "+_+":"+t+" is lost."),s.connected=!1,gml_Script_gmcallback_dsnet_disconnect(-1,-1,o)},o}function dsnet_js_disconnect(e){__dsnet_js_debug&&console.log("DSNET_WS: Disconnecting socket "+e),__dsnet__connections[e].ws_handle.close()}function dsnet_js_send(e,n,_){var t=new Uint8Array(n.slice(0,_));__dsnet_js_verbose&&console.log("DSNET_WS: Sending: ",t),__dsnet__connections[e].ws_handle.send(t)}